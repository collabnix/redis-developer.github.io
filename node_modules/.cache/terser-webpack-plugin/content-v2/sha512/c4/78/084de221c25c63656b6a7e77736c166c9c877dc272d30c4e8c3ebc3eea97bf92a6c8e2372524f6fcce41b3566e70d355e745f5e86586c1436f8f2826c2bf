{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{100:function(e,t,n){\"use strict\";n.r(t),n.d(t,\"frontMatter\",(function(){return s})),n.d(t,\"metadata\",(function(){return p})),n.d(t,\"toc\",(function(){return l})),n.d(t,\"default\",(function(){return d}));var r=n(3),a=n(7),i=(n(0),n(237)),o=(n(238),[\"components\"]),s={id:\"index-lesson_2\",title:\"Introducing Spring Data Redis\",sidebar_label:\"Spring Data Redis\",slug:\"/develop/java/redis-and-spring-course/lesson_2\"},p={unversionedId:\"develop/java/spring/redis-and-spring-course/lesson_2/index-lesson_2\",id:\"develop/java/spring/redis-and-spring-course/lesson_2/index-lesson_2\",isDocsHomePage:!1,title:\"Introducing Spring Data Redis\",description:\"Objectives\",source:\"@site/docs/develop/java/spring/redis-and-spring-course/lesson_2/index-lesson_2.mdx\",slug:\"/develop/java/redis-and-spring-course/lesson_2\",permalink:\"/develop/java/redis-and-spring-course/lesson_2\",editUrl:\"https://github.com/redis-developer/redis-developer/edit/master/docs/develop/java/spring/redis-and-spring-course/lesson_2/index-lesson_2.mdx\",version:\"current\",sidebar_label:\"Spring Data Redis\",sidebar:\"docs\",previous:{title:\"Spring and Redis: Up and Running\",permalink:\"/develop/java/redis-and-spring-course/lesson_1\"},next:{title:\"Object Mapping & Redis Repositories\",permalink:\"/develop/java/redis-and-spring-course/lesson_3\"}},l=[{value:\"Objectives\",id:\"objectives\",children:[]},{value:\"Agenda\",id:\"agenda\",children:[]},{value:\"Introducing Spring Data Redis\",id:\"introducing-spring-data-redis\",children:[]},{value:\"Redis template\",id:\"redis-template\",children:[]},{value:\"Using the redis template\",id:\"using-the-redis-template\",children:[]}],c={toc:l};function d(e){var t=e.components,n=Object(a.a)(e,o);return Object(i.b)(\"wrapper\",Object(r.a)({},c,n,{components:t,mdxType:\"MDXLayout\"}),Object(i.b)(\"h3\",{id:\"objectives\"},\"Objectives\"),Object(i.b)(\"p\",null,\"Configure a RedisTemplate and learn how to access different operation bundles to read and write data to and from Redis in a Spring REST controller.\"),Object(i.b)(\"h3\",{id:\"agenda\"},\"Agenda\"),Object(i.b)(\"p\",null,\"In this lesson, students will learn:\"),Object(i.b)(\"ul\",null,Object(i.b)(\"li\",{parentName:\"ul\"},\"How to configure the connection to Redis from the application\"),Object(i.b)(\"li\",{parentName:\"ul\"},\"How to access and configure the Spring Data RedisTemplate\"),Object(i.b)(\"li\",{parentName:\"ul\"},\"How to use opsForXXX to read and write data to Redis\"),Object(i.b)(\"li\",{parentName:\"ul\"},\"The basis of Spring\\u2019s @RestController\")),Object(i.b)(\"p\",null,\"If you get stuck:\"),Object(i.b)(\"ul\",null,Object(i.b)(\"li\",{parentName:\"ul\"},\"The progress made in this lesson is available on the redi2read github repository at \",Object(i.b)(\"a\",{parentName:\"li\",href:\"https://github.com/redis-developer/redi2read/tree/course/milestone-2\"},\"https://github.com/redis-developer/redi2read/tree/course/milestone-2\"))),Object(i.b)(\"h3\",{id:\"introducing-spring-data-redis\"},\"Introducing Spring Data Redis\"),Object(i.b)(\"p\",null,\"Spring Data Redis provides the abstractions of the Spring Data platform to Redis.\"),Object(i.b)(\"ul\",null,Object(i.b)(\"li\",{parentName:\"ul\"},Object(i.b)(\"strong\",{parentName:\"li\"},\"Spring Data\"),\" makes it easy to use data access technologies, relational and non-relational databases, map-reduce frameworks, and cloud-based data services.\\nTo learn more about Spring Data, see \",Object(i.b)(\"a\",{parentName:\"li\",href:\"https://spring.io/projects/spring-data\"},\"https://spring.io/projects/spring-data\"),\".\"),Object(i.b)(\"li\",{parentName:\"ul\"},Object(i.b)(\"strong\",{parentName:\"li\"},\"Spring Data Redis\"),\" provides access to Redis from Spring applications. It offers both low-level and high-level abstractions for interacting with Redis.\")),Object(i.b)(\"h3\",{id:\"redis-template\"},\"Redis template\"),Object(i.b)(\"p\",null,\"We will start by configuring a RedisTemplate, a class that provides a thread-safe bridge between Spring and Redis Commands. It handles connection management, freeing the developer from opening and closing  Redis connections.\"),Object(i.b)(\"p\",null,\"Start from the main application class, \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"Redi2readApplication\"),\", located at \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"src/main/java/com/redislabs/edu/redi2read/Redi2readApplication.java\"),\".\"),Object(i.b)(\"p\",null,\"Add a \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"@Bean\"),\" annotated method called redisTemplate, which takes a \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"RedisConnectionFactory\"),\" and returns a \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"RedisTemplate\"),\". This method will provide a configured bean of type \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"RedisTemplate\"),\" in the Spring container. We can inject this bean wherever we need to access Redis.\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},\"@Bean\\npublic RedisTemplate<?, ?> redisTemplate(RedisConnectionFactory connectionFactory) {\\n  RedisTemplate<?, ?> template = new RedisTemplate<>();\\n  template.setConnectionFactory(connectionFactory);\\n\\n  return template;\\n}\\n\")),Object(i.b)(\"p\",null,\"This requires the following imports:\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\",className:\"language-java\"},\"import org.springframework.context.annotation.Bean;\\nimport org.springframework.data.redis.connection.RedisConnectionFactory;\\nimport org.springframework.data.redis.core.RedisTemplate;\\n\")),Object(i.b)(\"p\",null,\"Notice that while the template types are generic, it is up to the serializers/deserializers to convert the given Objects to-and-from binary data correctly.\"),Object(i.b)(\"p\",null,\"We could also configure the Redis host and port programmatically by defining a \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"@Bean\"),\" annotated method that returns a \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"RedisConnectionFactory\"),\" (either a \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"JedisConnectionFactory\"),\" or \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"LettuceConnectionFactory\"),\") and use the \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"setHostName\"),\" and \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"setPort\"),\" methods.\"),Object(i.b)(\"p\",null,\"But since Spring Data Redis can configure the beans using a properties file (either Java Properties or YAML), we will use the \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"applications.properties\"),\" file instead.\"),Object(i.b)(\"p\",null,\"Spring Data Redis properties are prefixed with \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"spring.redis.\"),\". In the file \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"src/main/resources/application.properties\"),\" add the following properties:\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},\"spring.redis.host=localhost\\nspring.redis.port=6379\\n\")),Object(i.b)(\"p\",null,\"While we're at it, let\\u2019s also add an exclusion for the autoconfiguration of Spring Security. Since we\\u2019ve included the Maven dependency for Spring Security but have not yet configured it, Spring defaults on the safe side and protects all endpoints on the application. So, for now, we\\u2019ll disable security autoconfiguration until we decide to secure our services.\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},\"spring.redis.host=localhost\\nspring.redis.port=6379\\nspring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration\\n\")),Object(i.b)(\"h3\",{id:\"using-the-redis-template\"},\"Using the redis template\"),Object(i.b)(\"p\",null,\"To test the RedisTemplate, we\\u2019ll create a REST controller and use it to  perform some operations against our Redis instance.\"),Object(i.b)(\"p\",null,\"We will add the controller under the src/main/java/com/redislabs/edu/redi2read/controllers folder, which means it\\u2019ll live in the com.redislabs.edu.redi2read.controllers package.\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},\"package com.redislabs.edu.redi2read.controllers;\\n\\npublic class HelloRedisController {\\n\\n}\\n\")),Object(i.b)(\"p\",null,\"Next, let\\u2019s annotate the class with the \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"@RestController\"),\" and the \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"@RequestMapping\"),\" annotations. The controller will now listen to requests rooted at http://localhost:8080/api/redis.\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},'@RestController\\n@RequestMapping(\"/api/redis\")\\npublic class HelloRedisController {\\n\\n}\\n')),Object(i.b)(\"p\",null,\"Add the necessary import as shown next:\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},\"import org.springframework.web.bind.annotation.RequestMapping;\\nimport org.springframework.web.bind.annotation.RestController;\\n\")),Object(i.b)(\"p\",null,\"Next, let\\u2019s inject an \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"@Autowired\"),\" instance of \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"RedisTemplate\"),\". Notice that we will use concrete classes for the \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"K\"),\" and \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"V\"),\" parameter classes in \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"RedisTemplate<K,V>\"),\". \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"K\"),\" is the Redis key type (usually a \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"String\"),\") and \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"V\"),\", the Redis value type (i.e., something that maps to a Redis data structure).\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},'@RestController\\n@RequestMapping(\"/api/redis\")\\npublic class HelloRedisController {\\n\\n  @Autowired\\n  private RedisTemplate<String, String> template;\\n}\\n')),Object(i.b)(\"p\",null,\"Add the necessary import as shown next:\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},\"import org.springframework.beans.factory.annotation.Autowired;\\nimport org.springframework.data.redis.core.RedisTemplate;\\n\")),Object(i.b)(\"p\",null,\"Now, all we need is a controller method to run some Redis commands. We will use the Redis SET command (\",Object(i.b)(\"a\",{parentName:\"p\",href:\"https://redis.io/commands/set\"},\"https://redis.io/commands/set\"),\") as we previously demonstrated using the Redis CLI.\"),Object(i.b)(\"p\",null,\"First, we\\u2019ll create a String that will serve to prefix the keys that we write to Redis:\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},'private static final String STRING_KEY_PREFIX = \"redi2read:strings:\";\\n')),Object(i.b)(\"p\",null,\"The method is annotated with the \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"@PostMapping\"),\" with a path of \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"/strings\"),\", making the effective path for our post \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"/api/redis/strings\"),\". The \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"@Request\"),\" body and the return value of the method is a \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"Map.Entry<String, String>\"),\" which is convenient when dealing with name-value pairs.\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},'@PostMapping(\"/strings\")\\n@ResponseStatus(HttpStatus.CREATED)\\npublic Map.Entry<String, String> setString(@RequestBody Map.Entry<String, String> kvp) {\\n  return kvp;\\n}\\n')),Object(i.b)(\"p\",null,\"Add the necessary import as shown next:\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},\"import org.springframework.web.bind.annotation.PostMapping;\\nimport org.springframework.web.bind.annotation.ResponseStatus;\\n\")),Object(i.b)(\"p\",null,\"If we launch the application now with:\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},\"./mvnw clean spring-boot:run\\n\")),Object(i.b)(\"p\",null,\"We can use curl to invoke our \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"api/redis/strings\"),\" endpoint:\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},'$ curl --location --request POST \\'http://localhost:8080/api/redis/strings\\' \\\\\\n  --header \\'Content-Type: application/json\\' \\\\\\n  --data-raw \\'{ \"database:redis:creator\": \"Salvatore Sanfilippo\" }\\'\\n{\"database:redis:creator\":\"Salvatore Sanfilippo\"}\\n')),Object(i.b)(\"p\",null,\"This results in the JSON payload being echoed back. Let's complete the implementation of the setString method so that we can write a Redis string to the database:\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},'@PostMapping(\"/strings\")\\n@ResponseStatus(HttpStatus.CREATED)\\npublic Map.Entry<String, String> setString(@RequestBody Map.Entry<String, String> kvp) {\\n  template.opsForValue().set(STRING_KEY_PREFIX + kvp.getKey(), kvp.getValue());\\n\\n  return kvp;\\n}\\n')),Object(i.b)(\"p\",null,\"We will use the \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"RedisTemplate \"),\"instance template \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"opsForValue()\"),\" method to get an instance of \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"ValueOperations\"),\", which provides methods to execute operations performed on simple values (or \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"Strings\"),\" in Redis terminology).\\nThe Redis SET method is implemented using the (you guessed it!) \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"set()\"),\" method, which takes a key name and a value. We are prepending the KEY_SPACE_PREFIX to the key that's provided as an argument.\\nBefore you fire up another curl request, let\\u2019s start a Redis CLI instance with the MONITOR flag so that we can watch what transpires when we hit the server.\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},\"$ redis-cli MONITOR\\n\")),Object(i.b)(\"p\",null,\"Now, when you issue the POST request again, you should see output similar to:\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},'1617346602.221390 [0 172.19.0.1:58396] \"SET\" \"redi2read:strings:database:redis:creator\" \"Salvatore Sanfilippo\"\\n')),Object(i.b)(\"p\",null,\"We can launch another Redis CLI to query Redis ourselves:\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},'127.0.0.1:6379> KEYS *\\n1) \"redi2read:strings:database:redis:creator\"\\n127.0.0.1:6379> TYPE \"redi2read:strings:database:redis:creator\"\\nstring\\n127.0.0.1:6379> GET \"redi2read:strings:database:redis:creator\"\\n\"Salvatore Sanfilippo\"\\n127.0.0.1:6379>\\n')),Object(i.b)(\"p\",null,\"If we use the KEYS * command, we can see all of the keys stored in Redis (don\\u2019t do this on a production box with a lot of data,\\nas you\\u2019ll block your Redis instance while serving a massive response).\\nThe \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"redi2read:strings:database:redis:creator\"),\" key has been created, and it is a Redis String with a value of \",Object(i.b)(\"inlineCode\",{parentName:\"p\"},\"Salvatore Sanfilipo\"),\"\\nWe can now write strings to Redis through our REST controller.\\nNext, let\\u2019s add a corresponding GET method to our controller to read string values:\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},'@GetMapping(\"/strings/{key}\")\\npublic Map.Entry<String, String> getString(@PathVariable(\"key\") String key) {\\n  String value = template.opsForValue().get(STRING_KEY_PREFIX + key);\\n\\n  if (value == null) {\\n    throw new ResponseStatusException(HttpStatus.NOT_FOUND, \"key not found\");\\n  }\\n\\n  return new SimpleEntry<String, String>(key, value);\\n}\\n')),Object(i.b)(\"p\",null,\"With imports:\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},\"import java.util.AbstractMap.SimpleEntry;\\nimport org.springframework.web.bind.annotation.GetMapping;\\nimport org.springframework.web.bind.annotation.PathVariable;\\nimport org.springframework.web.server.ResponseStatusException;\\n\")),Object(i.b)(\"p\",null,\"We can now issue a GET request to retrieve String keys:\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},'$ curl --location --request GET \\'http://localhost:8080/api/redis/strings/database:redis:creator\\'\\n{\"database:redis:creator\":\"Salvatore Sanfilippo\"}\\n')),Object(i.b)(\"p\",null,\"On the Redis CLI monitor you should see:\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},'1617347871.901585 [0 172.19.0.1:58284] \"GET\" \"redi2read:strings:database:redis:creator\"\\n')),Object(i.b)(\"p\",null,\"Note that in order to return an error on a key not found, we have to check the result for null and throw an appropriate exception.\"),Object(i.b)(\"pre\",null,Object(i.b)(\"code\",{parentName:\"pre\"},'{\\n  \"timestamp\": \"2021-04-02T07:45:10.303+00:00\",\\n  \"status\": 404,\\n  \"error\": \"Not Found\",\\n  \"trace\": \"org.springframework.web.server.ResponseStatusException: 404...\\\\n\",\\n  \"message\": \"key not found\",\\n  \"path\": \"/api/redis/strings/database:neo4j:creator\"\\n}\\n')),Object(i.b)(\"p\",null,\"Keep in mind that this is a \\u201cdevelopment time\\u201d exception, appropriate to be shown on an error page meant for developers.\\nLikely, we would intercept this exception and create an API appropriate response (likely just the status and error fields above).\"))}d.isMDXComponent=!0},237:function(e,t,n){\"use strict\";n.d(t,\"a\",(function(){return d})),n.d(t,\"b\",(function(){return m}));var r=n(0),a=n.n(r);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=a.a.createContext({}),c=function(e){var t=a.a.useContext(l),n=t;return e&&(n=\"function\"==typeof e?e(t):s(s({},t),e)),n},d=function(e){var t=c(e.components);return a.a.createElement(l.Provider,{value:t},e.children)},b={inlineCode:\"code\",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},u=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,l=p(e,[\"components\",\"mdxType\",\"originalType\",\"parentName\"]),d=c(n),u=r,m=d[\"\".concat(o,\".\").concat(u)]||d[u]||b[u]||i;return n?a.a.createElement(m,s(s({ref:t},l),{},{components:n})):a.a.createElement(m,s({ref:t},l))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if(\"string\"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType=\"string\"==typeof e?e:r,o[1]=s;for(var l=2;l<i;l++)o[l]=n[l];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,n)}u.displayName=\"MDXCreateElement\"},238:function(e,t,n){\"use strict\";n.d(t,\"b\",(function(){return i})),n.d(t,\"a\",(function(){return o}));var r=n(20),a=n(246);function i(){var e=Object(r.default)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?\"/\":t,i=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,r){var i=void 0===r?{}:r,o=i.forcePrependBaseUrl,s=void 0!==o&&o,p=i.absolute,l=void 0!==p&&p;if(!n)return n;if(n.startsWith(\"#\"))return n;if(Object(a.b)(n))return n;if(s)return t+n;var c=n.startsWith(t)?n:t+n.replace(/^\\//,\"\");return l?e+c:c}(i,n,e,t)}}}function o(e,t){return void 0===t&&(t={}),(0,i().withBaseUrl)(e,t)}},246:function(e,t,n){\"use strict\";function r(e){return!0===/^(\\w*:|\\/\\/)/.test(e)}function a(e){return void 0!==e&&!r(e)}n.d(t,\"b\",(function(){return r})),n.d(t,\"a\",(function(){return a}))}}]);","name":"1d1b3f81.e94232d9.js","input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[32],{\n\n/***/ 100:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"frontMatter\", function() { return frontMatter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"metadata\", function() { return metadata; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"toc\", function() { return toc; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MDXContent; });\n/* harmony import */ var _Users_ajeetraina_staging_redis_developer_github_io_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(3);\n/* harmony import */ var _Users_ajeetraina_staging_redis_developer_github_io_node_modules_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(7);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(0);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _mdx_js_react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(237);\n/* harmony import */ var _docusaurus_useBaseUrl__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(238);\nvar _excluded=[\"components\"];var frontMatter={id:'index-lesson_2',title:'Introducing Spring Data Redis',sidebar_label:'Spring Data Redis',slug:'/develop/java/redis-and-spring-course/lesson_2'};var metadata={\"unversionedId\":\"develop/java/spring/redis-and-spring-course/lesson_2/index-lesson_2\",\"id\":\"develop/java/spring/redis-and-spring-course/lesson_2/index-lesson_2\",\"isDocsHomePage\":false,\"title\":\"Introducing Spring Data Redis\",\"description\":\"Objectives\",\"source\":\"@site/docs/develop/java/spring/redis-and-spring-course/lesson_2/index-lesson_2.mdx\",\"slug\":\"/develop/java/redis-and-spring-course/lesson_2\",\"permalink\":\"/develop/java/redis-and-spring-course/lesson_2\",\"editUrl\":\"https://github.com/redis-developer/redis-developer/edit/master/docs/develop/java/spring/redis-and-spring-course/lesson_2/index-lesson_2.mdx\",\"version\":\"current\",\"sidebar_label\":\"Spring Data Redis\",\"sidebar\":\"docs\",\"previous\":{\"title\":\"Spring and Redis: Up and Running\",\"permalink\":\"/develop/java/redis-and-spring-course/lesson_1\"},\"next\":{\"title\":\"Object Mapping & Redis Repositories\",\"permalink\":\"/develop/java/redis-and-spring-course/lesson_3\"}};/* @jsxRuntime classic */ /* @jsx mdx */var toc=[{value:'Objectives',id:'objectives',children:[]},{value:'Agenda',id:'agenda',children:[]},{value:'Introducing Spring Data Redis',id:'introducing-spring-data-redis',children:[]},{value:'Redis template',id:'redis-template',children:[]},{value:'Using the redis template',id:'using-the-redis-template',children:[]}];var layoutProps={toc:toc};var MDXLayout=\"wrapper\";function MDXContent(_ref){var components=_ref.components,props=Object(_Users_ajeetraina_staging_redis_developer_github_io_node_modules_babel_runtime_helpers_esm_objectWithoutPropertiesLoose__WEBPACK_IMPORTED_MODULE_1__[/* default */ \"a\"])(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(MDXLayout,Object(_Users_ajeetraina_staging_redis_developer_github_io_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])({},layoutProps,props,{components:components,mdxType:\"MDXLayout\"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"h3\",{\"id\":\"objectives\"},\"Objectives\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Configure a RedisTemplate and learn how to access different operation bundles to read and write data to and from Redis in a Spring REST controller.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"h3\",{\"id\":\"agenda\"},\"Agenda\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"In this lesson, students will learn:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"ul\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"li\",{parentName:\"ul\"},\"How to configure the connection to Redis from the application\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"li\",{parentName:\"ul\"},\"How to access and configure the Spring Data RedisTemplate\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"li\",{parentName:\"ul\"},\"How to use opsForXXX to read and write data to Redis\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"li\",{parentName:\"ul\"},\"The basis of Spring\\u2019s @RestController\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"If you get stuck:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"ul\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"li\",{parentName:\"ul\"},\"The progress made in this lesson is available on the redi2read github repository at \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"a\",{parentName:\"li\",\"href\":\"https://github.com/redis-developer/redi2read/tree/course/milestone-2\"},\"https://github.com/redis-developer/redi2read/tree/course/milestone-2\"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"h3\",{\"id\":\"introducing-spring-data-redis\"},\"Introducing Spring Data Redis\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Spring Data Redis provides the abstractions of the Spring Data platform to Redis.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"ul\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"li\",{parentName:\"ul\"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"strong\",{parentName:\"li\"},\"Spring Data\"),\" makes it easy to use data access technologies, relational and non-relational databases, map-reduce frameworks, and cloud-based data services.\\nTo learn more about Spring Data, see \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"a\",{parentName:\"li\",\"href\":\"https://spring.io/projects/spring-data\"},\"https://spring.io/projects/spring-data\"),\".\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"li\",{parentName:\"ul\"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"strong\",{parentName:\"li\"},\"Spring Data Redis\"),\" provides access to Redis from Spring applications. It offers both low-level and high-level abstractions for interacting with Redis.\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"h3\",{\"id\":\"redis-template\"},\"Redis template\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"We will start by configuring a RedisTemplate, a class that provides a thread-safe bridge between Spring and Redis Commands. It handles connection management, freeing the developer from opening and closing  Redis connections.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Start from the main application class, \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"Redi2readApplication\"),\", located at \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"src/main/java/com/redislabs/edu/redi2read/Redi2readApplication.java\"),\".\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Add a \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"@Bean\"),\" annotated method called redisTemplate, which takes a \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"RedisConnectionFactory\"),\" and returns a \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"RedisTemplate\"),\". This method will provide a configured bean of type \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"RedisTemplate\"),\" in the Spring container. We can inject this bean wherever we need to access Redis.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"@Bean\\npublic RedisTemplate<?, ?> redisTemplate(RedisConnectionFactory connectionFactory) {\\n  RedisTemplate<?, ?> template = new RedisTemplate<>();\\n  template.setConnectionFactory(connectionFactory);\\n\\n  return template;\\n}\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"This requires the following imports:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\",\"className\":\"language-java\"},\"import org.springframework.context.annotation.Bean;\\nimport org.springframework.data.redis.connection.RedisConnectionFactory;\\nimport org.springframework.data.redis.core.RedisTemplate;\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Notice that while the template types are generic, it is up to the serializers/deserializers to convert the given Objects to-and-from binary data correctly.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"We could also configure the Redis host and port programmatically by defining a \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"@Bean\"),\" annotated method that returns a \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"RedisConnectionFactory\"),\" (either a \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"JedisConnectionFactory\"),\" or \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"LettuceConnectionFactory\"),\") and use the \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"setHostName\"),\" and \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"setPort\"),\" methods.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"But since Spring Data Redis can configure the beans using a properties file (either Java Properties or YAML), we will use the \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"applications.properties\"),\" file instead.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Spring Data Redis properties are prefixed with \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"spring.redis.\"),\". In the file \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"src/main/resources/application.properties\"),\" add the following properties:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"spring.redis.host=localhost\\nspring.redis.port=6379\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"While we're at it, let\\u2019s also add an exclusion for the autoconfiguration of Spring Security. Since we\\u2019ve included the Maven dependency for Spring Security but have not yet configured it, Spring defaults on the safe side and protects all endpoints on the application. So, for now, we\\u2019ll disable security autoconfiguration until we decide to secure our services.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"spring.redis.host=localhost\\nspring.redis.port=6379\\nspring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"h3\",{\"id\":\"using-the-redis-template\"},\"Using the redis template\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"To test the RedisTemplate, we\\u2019ll create a REST controller and use it to  perform some operations against our Redis instance.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"We will add the controller under the src/main/java/com/redislabs/edu/redi2read/controllers folder, which means it\\u2019ll live in the com.redislabs.edu.redi2read.controllers package.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"package com.redislabs.edu.redi2read.controllers;\\n\\npublic class HelloRedisController {\\n\\n}\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Next, let\\u2019s annotate the class with the \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"@RestController\"),\" and the \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"@RequestMapping\"),\" annotations. The controller will now listen to requests rooted at http://localhost:8080/api/redis.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"@RestController\\n@RequestMapping(\\\"/api/redis\\\")\\npublic class HelloRedisController {\\n\\n}\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Add the necessary import as shown next:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"import org.springframework.web.bind.annotation.RequestMapping;\\nimport org.springframework.web.bind.annotation.RestController;\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Next, let\\u2019s inject an \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"@Autowired\"),\" instance of \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"RedisTemplate\"),\". Notice that we will use concrete classes for the \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"K\"),\" and \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"V\"),\" parameter classes in \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"RedisTemplate<K,V>\"),\". \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"K\"),\" is the Redis key type (usually a \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"String\"),\") and \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"V\"),\", the Redis value type (i.e., something that maps to a Redis data structure).\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"@RestController\\n@RequestMapping(\\\"/api/redis\\\")\\npublic class HelloRedisController {\\n\\n  @Autowired\\n  private RedisTemplate<String, String> template;\\n}\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Add the necessary import as shown next:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"import org.springframework.beans.factory.annotation.Autowired;\\nimport org.springframework.data.redis.core.RedisTemplate;\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Now, all we need is a controller method to run some Redis commands. We will use the Redis SET command (\",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"a\",{parentName:\"p\",\"href\":\"https://redis.io/commands/set\"},\"https://redis.io/commands/set\"),\") as we previously demonstrated using the Redis CLI.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"First, we\\u2019ll create a String that will serve to prefix the keys that we write to Redis:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"private static final String STRING_KEY_PREFIX = \\\"redi2read:strings:\\\";\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"The method is annotated with the \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"@PostMapping\"),\" with a path of \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"/strings\"),\", making the effective path for our post \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"/api/redis/strings\"),\". The \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"@Request\"),\" body and the return value of the method is a \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"Map.Entry<String, String>\"),\" which is convenient when dealing with name-value pairs.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"@PostMapping(\\\"/strings\\\")\\n@ResponseStatus(HttpStatus.CREATED)\\npublic Map.Entry<String, String> setString(@RequestBody Map.Entry<String, String> kvp) {\\n  return kvp;\\n}\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Add the necessary import as shown next:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"import org.springframework.web.bind.annotation.PostMapping;\\nimport org.springframework.web.bind.annotation.ResponseStatus;\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"If we launch the application now with:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"./mvnw clean spring-boot:run\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"We can use curl to invoke our \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"api/redis/strings\"),\" endpoint:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"$ curl --location --request POST 'http://localhost:8080/api/redis/strings' \\\\\\n  --header 'Content-Type: application/json' \\\\\\n  --data-raw '{ \\\"database:redis:creator\\\": \\\"Salvatore Sanfilippo\\\" }'\\n{\\\"database:redis:creator\\\":\\\"Salvatore Sanfilippo\\\"}\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"This results in the JSON payload being echoed back. Let's complete the implementation of the setString method so that we can write a Redis string to the database:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"@PostMapping(\\\"/strings\\\")\\n@ResponseStatus(HttpStatus.CREATED)\\npublic Map.Entry<String, String> setString(@RequestBody Map.Entry<String, String> kvp) {\\n  template.opsForValue().set(STRING_KEY_PREFIX + kvp.getKey(), kvp.getValue());\\n\\n  return kvp;\\n}\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"We will use the \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"RedisTemplate \"),\"instance template \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"opsForValue()\"),\" method to get an instance of \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"ValueOperations\"),\", which provides methods to execute operations performed on simple values (or \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"Strings\"),\" in Redis terminology).\\nThe Redis SET method is implemented using the (you guessed it!) \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"set()\"),\" method, which takes a key name and a value. We are prepending the KEY_SPACE_PREFIX to the key that's provided as an argument.\\nBefore you fire up another curl request, let\\u2019s start a Redis CLI instance with the MONITOR flag so that we can watch what transpires when we hit the server.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"$ redis-cli MONITOR\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Now, when you issue the POST request again, you should see output similar to:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"1617346602.221390 [0 172.19.0.1:58396] \\\"SET\\\" \\\"redi2read:strings:database:redis:creator\\\" \\\"Salvatore Sanfilippo\\\"\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"We can launch another Redis CLI to query Redis ourselves:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"127.0.0.1:6379> KEYS *\\n1) \\\"redi2read:strings:database:redis:creator\\\"\\n127.0.0.1:6379> TYPE \\\"redi2read:strings:database:redis:creator\\\"\\nstring\\n127.0.0.1:6379> GET \\\"redi2read:strings:database:redis:creator\\\"\\n\\\"Salvatore Sanfilippo\\\"\\n127.0.0.1:6379>\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"If we use the KEYS * command, we can see all of the keys stored in Redis (don\\u2019t do this on a production box with a lot of data,\\nas you\\u2019ll block your Redis instance while serving a massive response).\\nThe \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"redi2read:strings:database:redis:creator\"),\" key has been created, and it is a Redis String with a value of \",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"inlineCode\",{parentName:\"p\"},\"Salvatore Sanfilipo\"),\"\\nWe can now write strings to Redis through our REST controller.\\nNext, let\\u2019s add a corresponding GET method to our controller to read string values:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"@GetMapping(\\\"/strings/{key}\\\")\\npublic Map.Entry<String, String> getString(@PathVariable(\\\"key\\\") String key) {\\n  String value = template.opsForValue().get(STRING_KEY_PREFIX + key);\\n\\n  if (value == null) {\\n    throw new ResponseStatusException(HttpStatus.NOT_FOUND, \\\"key not found\\\");\\n  }\\n\\n  return new SimpleEntry<String, String>(key, value);\\n}\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"With imports:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"import java.util.AbstractMap.SimpleEntry;\\nimport org.springframework.web.bind.annotation.GetMapping;\\nimport org.springframework.web.bind.annotation.PathVariable;\\nimport org.springframework.web.server.ResponseStatusException;\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"We can now issue a GET request to retrieve String keys:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"$ curl --location --request GET 'http://localhost:8080/api/redis/strings/database:redis:creator'\\n{\\\"database:redis:creator\\\":\\\"Salvatore Sanfilippo\\\"}\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"On the Redis CLI monitor you should see:\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"1617347871.901585 [0 172.19.0.1:58284] \\\"GET\\\" \\\"redi2read:strings:database:redis:creator\\\"\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Note that in order to return an error on a key not found, we have to check the result for null and throw an appropriate exception.\"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"pre\",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"code\",{parentName:\"pre\"},\"{\\n  \\\"timestamp\\\": \\\"2021-04-02T07:45:10.303+00:00\\\",\\n  \\\"status\\\": 404,\\n  \\\"error\\\": \\\"Not Found\\\",\\n  \\\"trace\\\": \\\"org.springframework.web.server.ResponseStatusException: 404...\\\\n\\\",\\n  \\\"message\\\": \\\"key not found\\\",\\n  \\\"path\\\": \\\"/api/redis/strings/database:neo4j:creator\\\"\\n}\\n\")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_3__[/* mdx */ \"b\"])(\"p\",null,\"Keep in mind that this is a \\u201Cdevelopment time\\u201D exception, appropriate to be shown on an error page meant for developers.\\nLikely, we would intercept this exception and create an API appropriate response (likely just the status and error fields above).\"));};MDXContent.isMDXComponent=true;\n\n/***/ }),\n\n/***/ 237:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export MDXContext */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return MDXProvider; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return createElement; });\n/* unused harmony export useMDXComponents */\n/* unused harmony export withMDXComponents */\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(0);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nvar isFunction = function isFunction(obj) {\n  return typeof obj === 'function';\n};\n\nvar MDXContext = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createContext({});\nvar withMDXComponents = function withMDXComponents(Component) {\n  return function (props) {\n    var allComponents = useMDXComponents(props.components);\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Component, _extends({}, props, {\n      components: allComponents\n    }));\n  };\n};\nvar useMDXComponents = function useMDXComponents(components) {\n  var contextComponents = react__WEBPACK_IMPORTED_MODULE_0___default.a.useContext(MDXContext);\n  var allComponents = contextComponents;\n\n  if (components) {\n    allComponents = isFunction(components) ? components(contextComponents) : _objectSpread2(_objectSpread2({}, contextComponents), components);\n  }\n\n  return allComponents;\n};\nvar MDXProvider = function MDXProvider(props) {\n  var allComponents = useMDXComponents(props.components);\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(MDXContext.Provider, {\n    value: allComponents\n  }, props.children);\n};\n\nvar TYPE_PROP_NAME = 'mdxType';\nvar DEFAULTS = {\n  inlineCode: 'code',\n  wrapper: function wrapper(_ref) {\n    var children = _ref.children;\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment, {}, children);\n  }\n};\nvar MDXCreateElement = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.forwardRef(function (props, ref) {\n  var propComponents = props.components,\n      mdxType = props.mdxType,\n      originalType = props.originalType,\n      parentName = props.parentName,\n      etc = _objectWithoutProperties(props, [\"components\", \"mdxType\", \"originalType\", \"parentName\"]);\n\n  var components = useMDXComponents(propComponents);\n  var type = mdxType;\n  var Component = components[\"\".concat(parentName, \".\").concat(type)] || components[type] || DEFAULTS[type] || originalType;\n\n  if (propComponents) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Component, _objectSpread2(_objectSpread2({\n      ref: ref\n    }, etc), {}, {\n      components: propComponents\n    }));\n  }\n\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(Component, _objectSpread2({\n    ref: ref\n  }, etc));\n});\nMDXCreateElement.displayName = 'MDXCreateElement';\nfunction createElement (type, props) {\n  var args = arguments;\n  var mdxType = props && props.mdxType;\n\n  if (typeof type === 'string' || mdxType) {\n    var argsLength = args.length;\n    var createElementArgArray = new Array(argsLength);\n    createElementArgArray[0] = MDXCreateElement;\n    var newProps = {};\n\n    for (var key in props) {\n      if (hasOwnProperty.call(props, key)) {\n        newProps[key] = props[key];\n      }\n    }\n\n    newProps.originalType = type;\n    newProps[TYPE_PROP_NAME] = typeof type === 'string' ? type : mdxType;\n    createElementArgArray[1] = newProps;\n\n    for (var i = 2; i < argsLength; i++) {\n      createElementArgArray[i] = args[i];\n    }\n\n    return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement.apply(null, createElementArgArray);\n  }\n\n  return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement.apply(null, args);\n}\n\n\n\n\n/***/ }),\n\n/***/ 238:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return useBaseUrlUtils; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return useBaseUrl; });\n/* harmony import */ var _useDocusaurusContext__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(20);\n/* harmony import */ var _isInternalUrl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(246);\n/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */function addBaseUrl(siteUrl,baseUrl,url,_temp){var _ref=_temp===void 0?{}:_temp,_ref$forcePrependBase=_ref.forcePrependBaseUrl,forcePrependBaseUrl=_ref$forcePrependBase===void 0?false:_ref$forcePrependBase,_ref$absolute=_ref.absolute,absolute=_ref$absolute===void 0?false:_ref$absolute;if(!url){return url;}// it never makes sense to add a base url to a local anchor url\nif(url.startsWith('#')){return url;}// it never makes sense to add a base url to an url with a protocol\nif(Object(_isInternalUrl__WEBPACK_IMPORTED_MODULE_1__[/* hasProtocol */ \"b\"])(url)){return url;}if(forcePrependBaseUrl){return baseUrl+url;}// We should avoid adding the baseurl twice if it's already there\nvar shouldAddBaseUrl=!url.startsWith(baseUrl);var basePath=shouldAddBaseUrl?baseUrl+url.replace(/^\\//,''):url;return absolute?siteUrl+basePath:basePath;}function useBaseUrlUtils(){var _useDocusaurusContext=Object(_useDocusaurusContext__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(),_useDocusaurusContext2=_useDocusaurusContext.siteConfig;_useDocusaurusContext2=_useDocusaurusContext2===void 0?{}:_useDocusaurusContext2;var _useDocusaurusContext3=_useDocusaurusContext2.baseUrl,baseUrl=_useDocusaurusContext3===void 0?'/':_useDocusaurusContext3,siteUrl=_useDocusaurusContext2.url;return{withBaseUrl:function withBaseUrl(url,options){return addBaseUrl(siteUrl,baseUrl,url,options);}};}function useBaseUrl(url,options){if(options===void 0){options={};}var _useBaseUrlUtils=useBaseUrlUtils(),withBaseUrl=_useBaseUrlUtils.withBaseUrl;return withBaseUrl(url,options);}\n\n/***/ }),\n\n/***/ 246:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return hasProtocol; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return isInternalUrl; });\n/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */function hasProtocol(url){return /^(\\w*:|\\/\\/)/.test(url)===true;}function isInternalUrl(url){return typeof url!=='undefined'&&!hasProtocol(url);}\n\n/***/ })\n\n}]);","inputSourceMap":null}